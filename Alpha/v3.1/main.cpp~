#include "Controller.hpp"

int main(void)
{
  srand(time(NULL));

  string testInputDir = "../TestInput/EyeInputs/Test1/";

  cout << "system path escape: " << PATH_ESCAPE << endl;

  Controller app("../TestInput/EyeInputs/keyMap.txt");
  //app.SmokeTest();
  app.PerformanceTest(testInputDir);

  return 0;
}



/*

long double res, scalar = 1000000000.0;
  struct timespec begin, end;
  vector<string> output;
  vector<Point> inData;
  vector<PointMu> outData;
  Lattice testLattice;
  LatticePaths decoded;

  string testDataFile = "./signal.txt";

  //class components
  SingularityBuilder sb;
  LatticeBuilder lb;
  Viterbi vt;
  LanguageModel lm;

  //lattice and viterbi test
  cout << "Vini Vitti Viterbi..." << endl;
  clock_gettime(CLOCK_MONOTONIC,&begin);
  lb.TestBuildLattice(testLattice);
  vt.Process(testLattice, decoded);
  //lb.ClearLattice(testLattice);
  clock_gettime(CLOCK_MONOTONIC,&end);
  cout << "runtime: " << diffTimeSpecs(&begin,&end) << " (s)" << endl;

  cout << "decoded: ";
  if(decoded.size() > 0){
    cout << decoded.begin()->first << endl;
  }

  //full path-enumeration testing
  testLattice.clear();
  decoded.clear();
  cout << "Running exhaustive dfs graph search, no language modelling..." << endl;
  clock_gettime(CLOCK_MONOTONIC,&begin);
  lb.TestBuildLattice(testLattice);
  vt.RunExhaustiveSearch(testLattice,decoded,-1);
  clock_gettime(CLOCK_MONOTONIC,&end);
  cout << "runtime: " << diffTimeSpecs(&begin,&end) << " (s)" << endl;
  vt.PrintResultList(decoded);

  //try a basic pruned/beam search
  testLattice.clear();
  decoded.clear();
  //full path-enumeration testing
  cout << "Running pruned dfs graph search, NO language modelling..." << endl;
  clock_gettime(CLOCK_MONOTONIC,&begin);
  lb.TestBuildLattice(testLattice);
  vt.RunPrunedSearch(testLattice,decoded,-1);
  clock_gettime(CLOCK_MONOTONIC,&end);
  cout << "runtime: " << diffTimeSpecs(&begin,&end) << " (s)" << endl;
  vt.PrintResultList(decoded);

  testLattice.clear();
  decoded.clear();
  cout << "Running pruned dfs graph search with language models..." << endl;
  clock_gettime(CLOCK_MONOTONIC,&begin);
  lb.TestBuildLattice(testLattice);
  lb.PrintLattice(testLattice);
  vt.RunPrunedSearch(testLattice,decoded,-1);
  lm.Process(decoded);
  lm.MajorityVoteFilter(decoded, 20, 0, output);
  clock_gettime(CLOCK_MONOTONIC,&end);
  cout << "runtime: " << diffTimeSpecs(&begin,&end) << " (s)" << endl;
  cout << "after language model conditioning: " << endl;
  vt.PrintResultList(decoded);



  //read in some test data. note the chained pipe-transform pattern: output param of each class becomes input to next class

  sb.BuildTestData(testDataFile, inData);

  sb.Process(inData, outData);

  lb.BuildStaticLattice(outData, testLattice);

  vt.Process(testLattice, decoded);

  

*/
